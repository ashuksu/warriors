; PHP configuration for production environment.
; Logs errors, optimizes OPcache for performance.

[PHP]
; Error Reporting
display_errors = Off                                ; NEVER display errors to end-users
display_startup_errors = Off                        ; NEVER display startup errors
error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT ; Log all critical errors, but hide deprecation/strict notices
log_errors = On                                     ; All errors MUST be logged to a file
error_log = /var/log/php/error.log                  ; Specify the path to your PHP error log file.

; Resource Limits (Tune based on your application's needs and server resources)
memory_limit = 512M                                 ; Typically higher for production
post_max_size = 64M
upload_max_filesize = 64M
max_execution_time = 60                             ; Shorter execution time to prevent runaway scripts
max_input_time = 60                                 ; Shorter input time for large file uploads
default_socket_timeout = 60                         ; Reasonable timeout for external connections

; General Settings
expose_php = Off                                    ; CRITICAL FOR SECURITY: Hide PHP version information

; Timezone (Crucial for correct date/time handling)
date.timezone = Europe/Stockholm

[opcache]
; OPcache Configuration (optimized for maximum performance and aggressive caching)
opcache.enable = 1                                  ; Enable OPcache
opcache.enable_cli = 1                              ; Also enable for CLI commands
opcache.memory_consumption = 256                    ; Allocate more memory to cache more files
opcache.interned_strings_buffer = 32                ; Increase for more efficient string caching
opcache.max_accelerated_files = 20000               ; Increase to cache all application files
opcache.validate_timestamps = 0                     ; CRITICAL FOR PROD: DO NOT check for file changes (cache is always valid)
opcache.revalidate_freq = 0                         ; Ignored if validate_timestamps = 0
opcache.save_comments = 1                           ; Save comments (needed for some frameworks and reflection)
opcache.fast_shutdown = 1                           ; Speeds up request termination

; JIT (Just In Time Compiler) - PHP 8+
; Enable JIT for maximum raw performance in production.
opcache.jit = 1255                                  ; Optimal JIT mode for most applications
opcache.jit_buffer_size = 128M                      ; Buffer size for JIT

; Preloading (PHP 7.4+) - Uncomment and configure if used
; opcache.preload=/var/www/html/preload.php
; opcache.preload_user=www-data                     ; Or the user PHP-FPM runs as