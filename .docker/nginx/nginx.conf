worker_processes auto; # Automatically detect the number of CPU cores
error_log /var/log/nginx/error.log warn; # Log errors to this file, with 'warn' level
pid /var/run/nginx/nginx.pid; # Path to the PID file

events {
    worker_connections 1024; # Max connections per worker process
}

http {
    include       /etc/nginx/mime.types; # Include MIME type definitions
    default_type  application/octet-stream; # Default MIME type

    # Log format and access log file
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';
    access_log  /var/log/nginx/access.log main;

    sendfile        on; # Optimize file transfers
    tcp_nopush      on; # Optimize TCP packet sending
    tcp_nodelay     on; # Optimize TCP packet sending
    keepalive_timeout 65; # Timeout for keep-alive connections
    client_max_body_size 64M; # Max size of client request body (e.g., for file uploads)

    # Gzip Compression settings
    gzip on;                 # Enable gzip compression
    gzip_vary on;            # Add Vary: Accept-Encoding header
    gzip_proxied any;        # Compress content from proxied requests
    gzip_comp_level 6;       # Compression level (1-9, 6 is a good balance)
    gzip_buffers 16 8k;      # Number and size of buffers for compression
    gzip_http_version 1.1;   # Minimum HTTP version for compression
    gzip_min_length 256;     # Minimum response length to compress
    gzip_types               # MIME types to compress
        application/atom+xml
        application/geo+json
        application/javascript
        application/x-javascript
        application/json
        application/ld+json
        application/manifest+json
        application/rdf+xml
        application/rss+xml
        application/vnd.ms-fontobject
        application/wasm
        application/x-web-app-manifest+json
        application/xhtml+xml
        application/xml
        font/eot
        font/otf
        font/ttf
        image/bmp
        image/svg+xml
        image/x-icon
        text/cache-manifest
        text/css
        text/javascript
        text/plain
        text/vcard
        text/vnd.rim.location.xloc
        text/vtt
        text/x-component
        text/x-cross-domain-policy
        text/xml;

    include /etc/nginx/conf.d/*.conf; # Include all configuration files from conf.d directory
}